<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>모바일 이모티콘 표시</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column; /* 세로 방향으로 정렬 */
            align-items: center; /* 수평 중앙 정렬 */
            background-color: black; /* 배경색을 검정으로 설정 */
            color: white; /* 텍스트 색상 */
        }

        #animation {
            display: none; /* 기본적으로 숨김 */
            max-width: 100%; /* 화면에 맞게 조정 */
            height: auto; /* 비율 유지 */
            margin-top: 20px; /* 상단 여백 */
        }

        #topHalf {
            flex: 1; /* 상단 절반을 차지 */
            display: flex;
            justify-content: center; /* 수평 중앙 정렬 */
            align-items: center; /* 수직 중앙 정렬 */
            width: 100%; /* 전체 너비 */
        }

        #bottomHalf {
            flex: 1; /* 하단 절반을 차지 */
            width: 100%; /* 전체 너비 */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #currentWord {
            margin-top: 20px; /* 상단 여백 */
            font-size: 24px; /* 글자 크기 */
        }

        #animationURL {
            margin-top: 10px; /* 상단 여백 */
            font-size: 16px; /* 글자 크기 */
            word-wrap: break-word; /* 긴 URL 줄 바꿈 */
        }
    </style>
</head>
<body>
    <div id="topHalf">
        <img id="animation" src="" alt="애니메이션"> <!-- 이모티콘 이미지 -->
    </div>
    <div id="bottomHalf">
        <div id="currentWord">현재 단어: </div>
        <div id="animationURL">애니메이션 URL: </div>
    </div>

    <script>
        const animation = document.getElementById('animation');
        const currentWordDisplay = document.getElementById('currentWord');
        const animationURLDisplay = document.getElementById('animationURL');

        // 애니메이션 파일 매핑 (모든 URL에 2 추가)
        const animationMap = {
            '나': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '내': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '저': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '제': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '나는': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '내가': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '나를': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '내게': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '나에게': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '저는': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '저를': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '제가': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '제게': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '저에게': 'https://sangeunpark-hong.github.io/lucy/me2.gif',
            '너': 'https://sangeunpark-hong.github.io/lucy/you2.gif',
            '네': 'https://sangeunpark-hong.github.io/lucy/you2.gif',
            '당신': 'https://sangeunpark-hong.github.io/lucy/you2.gif',
            '너는': 'https://sangeunpark-hong.github.io/lucy/you2.gif',
            '너를': 'https://sangeunpark-hong.github.io/lucy/you2.gif',
            '너가': 'https://sangeunpark-hong.github.io/lucy/you2.gif',
            '네가': 'https://sangeunpark-hong.github.io/lucy/you2.gif',
            '당신을': 'https://sangeunpark-hong.github.io/lucy/you2.gif',
            '당신이': 'https://sangeunpark-hong.github.io/lucy/you2.gif',
            '당신에게': 'https://sangeunpark-hong.github.io/lucy/you2.gif',
            '네게': 'https://sangeunpark-hong.github.io/lucy/you2.gif',
            '너에게': 'https://sangeunpark-hong.github.io/lucy/you2.gif',
            '당신은': 'https://sangeunpark-hong.github.io/lucy/you2.gif',
            '너도': 'https://sangeunpark-hong.github.io/lucy/you2.gif', // 추가된 매핑
            '좋아': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '좋아요': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '좋다': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '좋네': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '그래': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '그래요': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '잘했어': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '잘했어요': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '잘한다': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '잘해요': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '알았어': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '알았어요': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '알겠어': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '알겠어요': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '싫어': 'https://sangeunpark-hong.github.io/lucy/No2.gif',
            '싫다': 'https://sangeunpark-hong.github.io/lucy/No2.gif',
            '싫어요': 'https://sangeunpark-hong.github.io/lucy/No2.gif',
            '아니': 'https://sangeunpark-hong.github.io/lucy/No2.gif',
            '아니에요': 'https://sangeunpark-hong.github.io/lucy/No2.gif',
            '아니요': 'https://sangeunpark-hong.github.io/lucy/No2.gif',
            '안': 'https://sangeunpark-hong.github.io/lucy/No2.gif',
            '아니야': 'https://sangeunpark-hong.github.io/lucy/No2.gif', // 추가된 매핑
            '나도': 'https://sangeunpark-hong.github.io/lucy/me2.gif', // 추가된 매핑
            '예': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '네': 'https://sangeunpark-hong.github.io/lucy/good2.gif',
            '응': 'https://sangeunpark-hong.github.io/lucy/good2.gif', // 추가된 매핑
            '맞아': 'https://sangeunpark-hong.github.io/lucy/good2.gif', // 추가된 매핑
            '도와줘': 'https://sangeunpark-hong.github.io/lucy/help2.gif', // 추가된 매핑
            '도와주세요': 'https://sangeunpark-hong.github.io/lucy/help2.gif', // 추가된 매핑
            '도와줄까': 'https://sangeunpark-hong.github.io/lucy/help_q2.gif', // 추가된 매핑
            '도와줄까요': 'https://sangeunpark-hong.github.io/lucy/help_q2.gif', // 추가된 매핑
            '사랑하니': 'https://sangeunpark-hong.github.io/lucy/love_q2.gif', // 추가된 매핑
            '사랑하나요': 'https://sangeunpark-hong.github.io/lucy/love_q2.gif', // 추가된 매핑
            '아주': 'https://sangeunpark-hong.github.io/lucy/very2.gif',
            '엄청': 'https://sangeunpark-hong.github.io/lucy/very2.gif',
            '너무': 'https://sangeunpark-hong.github.io/lucy/very2.gif',
            '완전': 'https://sangeunpark-hong.github.io/lucy/very2.gif',
            '더': 'https://sangeunpark-hong.github.io/lucy/very2.gif',
            '더욱': 'https://sangeunpark-hong.github.io/lucy/very2.gif',
            '많이': 'https://sangeunpark-hong.github.io/lucy/very2.gif',
            '안녕': 'https://sangeunpark-hong.github.io/lucy/HI2.gif',
            '안녕하세요': 'https://sangeunpark-hong.github.io/lucy/HI2.gif',
            '미안': 'https://sangeunpark-hong.github.io/lucy/sorry2.gif',
            '미안해요': 'https://sangeunpark-hong.github.io/lucy/sorry2.gif',
            '죄송해요': 'https://sangeunpark-hong.github.io/lucy/sorry2.gif',
            '미안해': 'https://sangeunpark-hong.github.io/lucy/sorry2.gif',
            '괜찮아': 'https://sangeunpark-hong.github.io/lucy/Thatsokay2.gif',
            '괜찮아요': 'https://sangeunpark-hong.github.io/lucy/Thatsokay2.gif',
            '축하해': 'https://sangeunpark-hong.github.io/lucy/congraturation2.gif',
            '축하해요': 'https://sangeunpark-hong.github.io/lucy/congraturation2.gif',
            '고마워': 'https://sangeunpark-hong.github.io/lucy/thanks2.gif',
            '감사해요': 'https://sangeunpark-hong.github.io/lucy/thanks2.gif',
            '고마워요': 'https://sangeunpark-hong.github.io/lucy/thanks2.gif',
            '고맙다': 'https://sangeunpark-hong.github.io/lucy/thanks2.gif',
            '사랑해': 'https://sangeunpark-hong.github.io/lucy/love2.gif',
            '사랑해요': 'https://sangeunpark-hong.github.io/lucy/love2.gif'
        };

        // 음성 인식 설정
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'ko-KR';
        recognition.continuous = true; // 계속해서 음성 인식
        recognition.interimResults = true; // 중간 결과 활성화

        recognition.onstart = () => {
            console.log('- 음성 인식 중...');
        };

        let lastWord = '';
        let debounceTimeout;

        recognition.onresult = (event) => {
            const text = Array.from(event.results)
                .map(result => result[0])
                .map(result => result.transcript)
                .join('');

            const words = text.split(' ');
            if (words.length > 0) {
                const currentWord = words[words.length - 1].trim(); // 현재 단어를 가져오고 공백 제거
                currentWordDisplay.textContent = '현재 단어: ' + currentWord; // 현재 단어를 화면에 표시
                console.log('현재 단어:', currentWord); // 현재 단어를 콘솔에 출력

                // 디바운싱 적용
                clearTimeout(debounceTimeout);
                debounceTimeout = setTimeout(() => {
                    if (currentWord !== lastWord) {
                        lastWord = currentWord;

                        // 애니메이션 재생
                        if (animationMap[currentWord]) {
                            animation.src = animationMap[currentWord];
                            animation.style.display = 'block';
                            animationURLDisplay.textContent = '애니메이션 URL: ' + animation.src; // 애니메이션 URL을 화면에 표시
                            console.log('애니메이션 URL:', animation.src); // 애니메이션 URL을 콘솔에 출력
                        } else {
                            animation.style.display = 'none'; // 애니메이션이 없을 경우 숨김
                            animationURLDisplay.textContent = '애니메이션 URL: '; // URL 초기화
                        }
                    }
                }, 500); // 디바운싱 시간을 500ms로 늘림
            }
        };

        recognition.onerror = (event) => {
            console.error('오류 발생:', event.error);
        };

        recognition.onend = () => {
            console.log('음성 인식 종료');
            setTimeout(() => {
                recognition.start(); // 짧은 대기 후 자동으로 다시 시작
            }, 1000); // 1초 대기
        };

        // 모든 GIF 미리 로드
        Object.values(animationMap).forEach(src => {
            const img = new Image();
            img.src = src; // 미리 로드
        });

        recognition.start();
    </script>
</body>
</html>
